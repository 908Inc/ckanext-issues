<html xmlns:py="http://genshi.edgewall.org/"
      xmlns:i18n="http://genshi.edgewall.org/i18n"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      py:strip="">

  <py:def function="page_title">Todo List</py:def>
  <link rel="stylesheet"  type="text/css" media="screen, print"
        href="/ckanext-todo/css/main.css"
        py:def="optional_head()" />

  <div py:match="content" class="package">
    <h2 class="head">Todo List</h2>

    <div id="todo-page" py:choose="">
        <span py:when="not c.categories">
            There are currently no todo items.
        </span>

        <div py:otherwise="">
            <ul id="todo-categories">
                <py:for each="category in c.categories">
                <li><a href="#${category.name}">${category.name}</a> 
                    (${category.todo_count})
                </li> 
                </py:for>
            </ul>

            <py:for each="category in c.categories">
            <div class="todo-category">
                <h4 id="${category.name}">${category.name}</h4>
                <ul>
                    <py:for each="todo in category.todo">
                    <li>
                        <div py:choose="">Package: 
                            <span py:when="not todo.package_id">None</span>
                            <span py:otherwise="">
                                ${h.link_to(c.pkg_names[todo.package_id],
                                            h.url_for(controller='package', action='read',
                                                      id = c.pkg_names[todo.package_id]))}
                            </span>
                        </div>
                        <div>Description: ${todo.description}</div>
                        <div>Created: ${todo.created.strftime('%d %h %Y')}</div>
                    </li> 
                    </py:for>
                </ul>
            </div>
            </py:for>
        </div>
    </div>
  </div> <!-- content -->

  <xi:include href="package/layout.html" />
</html>
